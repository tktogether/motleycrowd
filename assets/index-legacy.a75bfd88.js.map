{"version":3,"file":"index-legacy.a75bfd88.js","sources":["../../src/i18n/index.js"],"sourcesContent":["export default class Lang {\n    constructor({save, load}) {\n        this.#save = save;\n        this.#load = load;\n    }\n\n    /**\n     * @typedef {{[key: string]: LangString}} LSProxy\n     */\n    #save;\n    #load;\n    /** @type {LSProxy} */\n    #g;\n    /** @type {LSProxy} */\n    #t;\n    /** @type {LSProxy} */\n    #e;\n    #lang;\n    #cache = new Map();\n\n    async initialize() {\n        const lang = this.#load();\n        await this.#switch(lang);\n    }\n\n    async #import(lang) {\n        if(this.#cache.has(lang))\n            return this.#cache.get(lang);\n\n        const {general, tips, error, moment} = await import(`./langs/${lang}.js`);\n\n        const ls = (data, notfind)=>{\n            const map = new Map();\n            for(const key in data)\n                map.set(key, new LangString(data[key]));\n            return new Proxy(map, {\n                get: (target, key) => {\n                    if(target.has(key))\n                        return target.get(key);\n                    if(notfind) return notfind(target, key);\n                    return new LangString(key);\n                }\n            });\n        }\n\n        const data = {\n            general: ls(general),\n            tips: ls(tips),\n            error: ls(error, target=>target.get('unknow')),\n            moment,\n        }\n\n        this.#cache.set(lang, data);\n        return data;\n    }\n\n    async #switch(lang) {\n        const {general, tips, error, moment} = await this.#import(lang);\n        this.#g = general;\n        this.#t = tips;\n        this.#e = error;\n        this.#lang = lang;\n        $moment.updateLocale(lang, moment);\n        $moment.locale(lang);\n    }\n\n    async switch(lang) {\n        await this.#switch(lang);\n        this.#save(lang);\n    }\n\n    get lang() {return this.#lang;}\n\n    /** @readonly */\n    get general() {return this.#g;}\n    /** @readonly */\n    get g() {return this.#g;}\n    /** @readonly */\n    get tips() {return this.#t;}\n    /** @readonly */\n    get t() {return this.#t;}\n    /** @readonly */\n    get error() {return this.#e;}\n    /** @readonly */\n    get e() {return this.#e;}\n\n    f(str, values, ...args) {\n        return this.format(str, values, ...args);\n    }\n\n    format(str, values, ...args) {\n        return $utils.format(\n            this.#g[str] || str,\n            values, ...args\n        ) || '';\n    }\n}\n\nclass LangString extends String {\n    format(values, ...args) {\n        return $utils.format(this, values, ...args);\n    }\n\n    f(values, ...args) {\n        return this.format(values, ...args);\n    }\n}"],"names":["Lang","_ref","save","load","_classCallCheck","this","_classPrivateMethodInitSpec","_switch","_import","_classPrivateFieldInitSpec","_save","writable","value","_load","_g","_t","_e","_lang","_cache","_classPrivateFieldSet","_initialize","_createClass","key","_asyncToGenerator","_regeneratorRuntime","mark","lang","_classPrivateFieldGet","_context","next","_classPrivateMethodGet","_switch2","call","stop","_callee","apply","arguments","_switch3","_x","toString","_ref2","wrap","_context2","prev","_callee2","_x2","get","str","values","args","Array","_len","_key","format","_$utils","$utils","_import2","_x3","_import3","_callee3","_yield$__variableDyna","general","tips","error","moment","ls","data","_context3","has","abrupt","__variableDynamicImportRuntimeHelper","Object","assign","__vitePreload","module","import","concat","notfind","map","Map","set","Proxy","target","LangString","_x4","_switch4","_callee4","_yield$_classPrivateM","_context4","$moment","updateLocale","locale","exports","_String","_inherits","_super","String","_key3","_$utils2","_len4","length","_key4"],"mappings":"wxTAAqBA,IAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EAAAA,IAAAA,QAAAA,EACjB,WAAA,SAAAA,EAAAC,OAAiBC,EAAAD,EAAJC,KAAMC,EAAAA,EAAAA,KAiBVC,EAAAC,KAAAL,GAAAM,EAAAD,KAAAE,GAAAD,EAAAD,KAAAG,GAAAC,EAAAJ,KAAAK,EAAA,CAAAC,UAAA,EAAAC,WAAA,IAAAH,EAAAJ,KAAAQ,EAAA,CAAAF,UAAA,EAAAC,WAAA,IAAAH,EAAAJ,KAAAS,EAAA,CAAAH,UAAA,EAAAC,WAAA,IAAAH,EAAAJ,KAAAU,EAAA,CAAAJ,UAAA,EAAAC,WAAA,IAAAH,EAAAJ,KAAAW,EAAA,CAAAL,UAAA,EAAAC,WAAA,IAAAH,EAAAJ,KAAAY,EAAA,CAAAN,UAAA,EAAAC,WAAA,IAAAH,EAAAJ,KAAAa,EAAA,CAAAP,UAAA,EAAAC,MAAA,UAhBLO,EAAId,KAAAK,EAASR,GACbiB,EAAAd,KAAaF,EAAAA,EAChB,CAEL,IAAAiB,EAyFK,OAzFLC,EAAArB,EAAA,CAAA,CAAAsB,IAAA,aAAAV,OAAAQ,EAAAG,EAAAC,IAAAC,MAcI,SACUC,IAAAA,IAAAA,EAAAA,OAAAA,IAAAA,MAAAA,SAAAA,GAAAA,OAAAA,OAAAA,EAAAA,KAAAA,EAAAA,MAAAA,KAAAA,EAAW,OAAXA,EAAOC,EAAAtB,aAAAA,MAAIuB,EAAAC,KAAA,EAAAC,EACXzB,KAAIE,EAAAwB,GAAAC,KAAJ3B,KAAaqB,GACtB,KAAA,EAAA,IAAA,MAAA,OAAAE,EAAAK,OAAA,GAAAC,EAAA7B,KAAA,KAAA,WAAA,OAAAe,EAAAe,MAAA9B,KAAA+B,UAAA,IAAA,CAAAd,IAAA,SAAAV,MAAA,SAAAyB,GAAA,SAAA9B,EAAA+B,GAAA,OAAAD,EAAAF,MAAA9B,KAAA+B,UAAA,CAAA,OAAA7B,EAAAgC,SAAA,WAAA,OAAAF,EAAAE,UAAA,EAAAhC,CAAA,CAAA,CAAA,WAAA,IAAAiC,EAAAjB,EAAAC,IAAAC,MA2CD,SAAaC,EAAAA,GACH,OAAAF,IAAAiB,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAb,MAAA,KAAA,EAAA,OAAAa,EAAAb,KAAA,EAAAC,EAAAzB,KAAAE,EAAAwB,GAAAC,KAAA3B,KAAaqB,GACnB,KAAA,EAAAC,EAAAtB,KAAAK,GAAAsB,KAAA3B,KAAWqB,GAAM,KACpB,EAAA,IAAA,MAAA,OAAAgB,EAAAT,OAAA,GAAAW,EAAAvC,KAAA,KAAA,OAAA,SAAAwC,GAAA,OAAAL,EAAAL,MAAA9B,KAAA+B,UAAA,CAAA,CA9CA,KA8CA,CAAAd,IAAA,OAAAwB,IAED,WAAY,OAAOnB,EAAAtB,KAAWY,EAAA,GAG9B,CAAAK,IAAA,UAAAwB,IAAA,WAAe,OAAAnB,EAAOtB,KAAQS,EAAA,GAE9B,CAAAQ,IAAA,IAAAwB,IAAA,WAAS,OAAAnB,EAAOtB,KAAIS,EAAI,GAC5B,CAAAQ,IAAA,OAAAwB,IACI,WAAY,OAAOnB,EAAAtB,OAAQ,GAC/B,CAAAiB,IAAA,IAAAwB,IACI,WAAS,OAAOnB,EAAAtB,OAAQ,GAC5B,CAAAiB,IAAA,QAAAwB,IACI,WAAa,OAAOnB,EAAAtB,OAAQ,GAChC,CAAAiB,IAAA,IAAAwB,IACI,WAAS,OAAOnB,EAAAtB,KAAQW,EAAA,GAExB,CAAAM,IAAA,IAAAV,MAAA,SAAEmC,EAAKC,8BAAWC,EAAI,IAAAC,MAAAC,EAAA,EAAAA,EAAA,EAAA,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAJH,EAAIG,EAAA,GAAAhB,UAAAgB,GAClB,OAAO/C,KAAKgD,OAALlB,MAAA9B,KAAY0C,CAAAA,EAAKC,UAAWC,GACtC,GAED,CAAA3B,IAAA,SAAAV,MAAA,SAAOmC,EAAKC,GAAWC,IAAAA,IAAAA,EAAAA,EAAAA,UAAAA,OAAAA,EAAAA,IAAAA,MAAAA,EAAAA,EAAAA,EAAAA,EAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,oBACnB,OAAOK,EAAAC,QAAOF,OAAMlB,MAAAmB,EAAA,CAChB3B,OAAQoB,GAAAA,IAAQA,EAChBC,GAAWC,OAAAA,KACV,EACR,KAAAjD,CAAA,CA9FD,GA8FC,SAAAwD,EAAAC,GAAA,OAAAC,EAAAvB,MAAA9B,KAAA+B,UAAA,CAAA,SAAAsB,IA1Cc,OA0CdA,EAAAnC,EAAAC,IAAAC,MAAA,SAAAkC,EAtEajC,GAAI,IAAAkC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA1C,IAAAiB,MAAA,SAAA0B,GAAA,OAAA,OAAAA,EAAAxB,KAAAwB,EAAAtC,MAAA,KAAA,EAAA,IACXF,EAAItB,KAAAa,GAAQkD,IAAI1C,GAAK,CAAAyC,EAAAtC,KAAA,EAAA,KAAA,CAAA,OAAAsC,EAAAE,OAAA,SACb1C,EAAItB,KAAAa,GAAQ4B,IAAIpB,IAEkB4C,KAAAA,EAAAA,OAAAA,EAAAA,KAAAA,EAAAA,EAAAC,OAAAC,OAAA,CAAA,mBAAA,WAAAC,OAAAA,GAAA,WAAA,OAAAC,EAAAC,OAAA,qCAAA,EAAA,IAAA,WAAAC,OAAAlD,EAAA,QAAtCmC,KAAAA,EAuBqB,OAvBrBA,EAAAA,EAAAA,KAAAA,IAAAA,QAASC,EAAIF,EAAJE,KAAMC,EAAKH,EAALG,MAAOC,EAAMJ,EAANI,OAEvBC,EAAK,SAACC,EAAMW,GACd,IAASC,EAAG,IAAIC,IAChB,IAAI,IAAMzD,KAAO4C,EACbY,EAAIE,IAAI1D,EAAK,MAAe4C,EAAK5C,KACrC,OAAO,IAAS2D,MAACH,EAAK,CAClBhC,IAAK,SAACoC,EAAQ5D,GACV,OAAG4D,EAAOd,IAAI9C,GACG4D,EAACpC,IAAIxB,GACnBuD,EAAuBA,EAACK,EAAQ5D,GACxB6D,IAAAA,EAAW7D,EACzB,GAER,EAEK4C,EAAO,CACTL,QAASI,EAAGJ,GACZC,KAAMG,EAAGH,GACTC,MAAOE,EAAGF,GAAO,SAAAmB,GAAM,OAAQA,EAACpC,IAAI,SAAU,IAC9CkB,OAAAA,GAGJrC,EAAItB,KAAAa,GAAQ8D,IAAItD,EAAMwC,GAAMC,EAAAE,OAAA,SACrBH,GAAI,KAAA,GAAA,IAAA,MAAA,OAAAC,EAAAlC,OAAA,GAAA0B,EAAAtD,KAAA,MAAA8B,MAAA9B,KAAA+B,UAAA,CAAA,SAAAL,EAAAqD,GAAA,OAAAC,EAAAlD,MAAA9B,KAAA+B,UAAA,CAAA,SAAAiD,IAUU,OAVVA,EAAA9D,EAAAC,IAAAC,MAAA,SAAA6D,EAGD5D,GAAI,IAAA6D,EAAA1B,EAAAC,EAAAC,EAAAC,EAAA,OAAAxC,IAAAiB,MAAA,SAAA+C,GAAA,OAAA,OAAAA,EAAA7C,KAAA6C,EAAA3D,MAAA,KAAA,EAAA,OAAA2D,EAAA3D,KAAA,EAAAC,EAC+BzB,KAAAG,EAAAgD,GAAAxB,KAAA3B,KAAaqB,GAAnDmC,KAAAA,EAAAA,EAAAA,EAAAA,KAAAA,IAAAA,QAASC,EAAIyB,EAAJzB,KAAMC,EAAAA,EAAAA,MAAOC,EAAAA,EAAAA,OAC7B7C,EAAAd,KAAUwD,EAAAA,GACV1C,EAAAd,KAAUyD,EAAAA,GACV3C,EAAId,KAAAW,EAAM+C,GACV5C,EAAId,KAAAY,EAASS,GACb+D,QAAQC,aAAahE,EAAMsC,GAC3ByB,QAAQE,OAAOjE,GAAM,KAAA,GAAA,IAAA,MAAA,OAAA8D,EAAAvD,OAAA,GAAAqD,EAAAjF,KAAA,MAAA8B,MAAA9B,KAAA+B,UAAA,CAiC5BwD,EAAA,UAAA5F,GAAA,IAEKmF,EACF,SAAAU,yRAAAC,CAAAX,EAAAU,GAAA,QAAAE,KAAAZ,qJAAA,SAAAA,IAAA,OAAA/E,EAAAC,KAAA8E,GAAAY,EAAA5D,MAAA9B,KAAA+B,UAAA,CADqB4D,OACrB3E,EAAA8D,EAAA,CAAA,CAAA7D,IAAA,SAAAV,MAAA,SAAOoC,GAAWC,IAAAA,IAAAA,EAAAA,EAAAA,UAAAA,OAAAA,EAAAA,IAAAA,MAAAA,EAAAA,EAAAA,EAAAA,EAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,EACdgD,EAAA,GAAA7D,UAAA6D,GAAA,SAAO1C,QAAOF,OAAMlB,MAAA+D,EAAA,CAAC7F,KAAM2C,GAAM4B,OAAK3B,GACzC,GAED,CAAA3B,IAAA,IAAAV,MAAA,SAAEoC,GAAiB,IAAA,IAAAmD,EAAA/D,UAAAgE,OAANnD,EAAI,IAAAC,MAAAiD,EAAA,EAAAA,EAAA,EAAA,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAJpD,EAAIoD,EAAA,GAAAjE,UAAAiE,GACb,OAAOhG,KAAKgD,OAALlB,MAAA9B,KAAY2C,CAAAA,UAAWC,GACjC,KAPoB+C,CAAAA,CACrB,CADqBA,EAAAA"}